<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCQ Game</title>
    <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAACXBIWXMAAC4jAAAuIwF4pT92AAAFsklEQVRIie1WS3McVxX+zuk7o8c8JM2oW61XPJJla6yRnIcpG8dAHpUNySZBLMKGHQUFq2xSYcOCBfAHwiaLbHgsMBTZAKlQMSlccRFcliMrelliJOSRNK+e0Tw1M933ZDFYKPYYlVnnVC/uOX3q+7rPPfd8F/jSTjA6MWOM+p42RhJsD1FwkAIA8lJLS3lJp297uztS/P8Jpjg6r+Zm2T6K5KQKoE3Tts90+qp7Z0PnHpvgdfXkK+pce/2eu/yRtxmh3nWdA+QMm47UnjMmX1WJdsKf3NXfurcfg+BN/3NzPAzg581r21KoSlOBXego9RIoJ9W220v+GPX/2P9i+1d+0bz2MJTxcOgt/wuzbK/qzNutG2s66yejBe+CMZaTqsnBblJlaTxjjKak5CNjV0qLes+iUIKH4mxd95InELyunrpixJLa+Wnzr47UAHzNiKWkFKKuLlICMChM3Qx2pHbFiCXFKUj9upd8koen2eyB747ePw7Ix50RCr+i4hVpvuveBHDFiAXJv6Izz6vTGakMUTAEfxD+YQqlpfyiMbWqMwHyXzFiAN51b5al8U01PUp9jyT4nu8SgF+2bmzrAoBbXmpezRWl3hR3zrBd6ATbcbZqaM0aNhFyUv22mlvQuwDu6eLbrY8BfN936TimOlpZFJziKIAVnbYoOMND21L4g7v0LTW7KXkb4REOn6IBTzSABty81L7ru/A7d9GmYIwjyzq9qrMAJjhiUTAjlQf34CU1NcND77nL6zp7gMO0lC8Z46c4kpKDabKi1BNGTxKOI/VhCgeoy6TgXZ1LsD1Igb/rZEHqBghAnK0qGm2yL5So3Zfve2v91HPRGD/Ng596ey70MIUD5GPwumSVsA+cFCdAvj7qGqWwC+9TvTdJ0YvGeJR63/fWAZzn4Q4lsikEYJACSe3UdMum4Bj3FaQWpH4GJcWZZjNOpiIjqZ3P9P4ZHgSQkcoohTNS3dJOWRoxHmhXuwNBH3VnpJKTqk2hLlIAWtAzbI1T/5Y4FgWe5hECAZhmc1dKu1Ke5IgSXtEZQKLUG4A/L7V9Kbe/tUMXAZD/RAkA3XcJ1H46JrdTHn77IMGBHFoUNCmwL+WMVABS4HWd3dD5YQoVpX60b2s6W5DaCIU3dX5VZxUYQFYq+1KOUq9NoZIcdihRWsp91J2XmkXBCY40xE1J6TzbPmIAZ9lc0Zm0lAE4Uj/DJiAGsYXgot7rR0+C7S3t5KQGICPVI9j/tukA9c7wUAveot77txSLUn/WOOWDSkslTN2K2KaQg5oLPcWDLnRFmkntBKjLpMA/vZ0tKTThvaymz7H1N2+zQ5ve8LYBvKoSGjJEwWeN2KrOfuCtn+bIsk7f06W0VM6xFSdzT0opfbCiM5Mc+cBbX9Hpy8Ypm0Ia8pqaBfCxt91hDzJS2dR5AHG2slL90NvY0cV5Nffr1kIXVAmHS3p/Q+c3Jb+k94uod8H4VWthXs2ldOlDbyMrlWk2ASS1k75/jPFAF73T+geAH/ouP8H9AC4YY79374Spm4luevd8MBa81G1vrwvqlpcCMEA9V93FZ4xRAGPc/yPfZQDvtD45jvmFcV1Goxtq1rAnKHLN29yRYhPeRWP8I+9fT3B/HrVDuA24ZTQGqPcTvfMVY3xNZ9uy/Ibv68Mc/ou7dl1vPZIAwJLej7N5ls04m3tSLkg9h9ohWhMcuatzYeomYEcfjHPfjhxkUWnCm+DID3xfnWazrVEPAHZQtOve1jSbCR563ji9ojMFqbvQWak24SlwA14FjaxUPQiDpjj6E/9LFgWXdfpnnSTzkaL/HfXUyyoOQCB/vC/6d3UOwBkedKT2DWPyNZVoH+A/u2u/cRc64vyva8tZHpxX52fYOoq0p/zxWbaiM1fdO+v3u/7xCNo2Rn0XjNFZtk0KRqkXgCO1jFSX9P4tL3XixetLO9E+B7lwwXS1U4NzAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon" />
    <link rel="stylesheet" href="pre_game.css">
</head>
<body>

    <div id="main_container" >

        <div id="A4_sheet" style="height: 940px; width: 700px; border: solid 1px #ffffff;">
            <div id="question-container" style="width:620px; margin-top:16px; margin-left:20px; column-count: 2; column-gap: 60px; column-rule: solid 1px #808080;">
             Loading questions...
            </div>
        </div>
        
        <div id="notes-container" style="opacity: 0; position:absolute; top: 20px; left:710px; width: 1200px; margin-top: 16px; padding-left: 10px;">
            Placeholder <!-- opacity in style has been kept to 0 as default. js below will change it -->
        </div> 
    
    </div>
    
        <div class="navigation"  style="width:702px;">
            <button id="prev-page" disabled>&laquo; Previous&nbsp;</button>
    
            <button id="toggle-ans" > Show Ans&nbsp;</button>
            <button id="toggle-notes" > Show Notes</button>
            <button id="toggle-ans-reveal" > Reveal Ans</button>

            <button id="next-page" disabled>&nbsp;&nbsp;&nbsp;Next &raquo;&nbsp;&nbsp;&nbsp;</button>
        </div>

    <script src="pre_game_json_locator.js" defer> </script>
    <script src="pre_game_q_renderer.js" defer> </script>
    <script src="pre_game_reset_button.js" defer> </script>
    <script>

    </script>


    <script>     
    // Function to toggle opacity of notes-container
const toggleNotesOpacity = () => {
    const notesContainer = document.getElementById('notes-container');

    // Check the current opacity
    const currentOpacity = window.getComputedStyle(notesContainer).opacity;

    // Toggle opacity between 0 and 1
    if (currentOpacity === '0') {
        notesContainer.style.opacity = '1';
    } else {
        notesContainer.style.opacity = '0';
    }
};

// Add event listener to the button (assuming toggle-notes is the button)
const toggleNotesButton = document.getElementById('toggle-notes');
toggleNotesButton.addEventListener('click', toggleNotesOpacity);
</script>


<script>

document.addEventListener('DOMContentLoaded', async function () {
    const revealAnsButton = document.getElementById('toggle-ans-reveal');
    let answersRevealed = false; // Track the toggle state

    const getPaperNameFromURL = () => {
        const urlParams = new URLSearchParams(window.location.search);
        const paperName = urlParams.get('paper');
        console.log(`Paper name extracted from URL: ${paperName}`);
        return paperName;
    };

    const fetchQuestions = async (paperName) => {
        try {
            console.log(`Fetching JSON file: data/${paperName}.json`);
            const response = await fetch(`data/${paperName}.json`);
            if (!response.ok) throw new Error('Failed to load questions');
            console.log('JSON file loaded successfully');
            return await response.json();
        } catch (error) {
            console.error('Error loading JSON:', error);
            return null;
        }
    };

    const revealAnswers = async () => {
        const paperName = getPaperNameFromURL();
        const questionData = await fetchQuestions(paperName);

        if (!questionData) {
            console.error('No question data found');
            return;
        }

        console.log('Question data loaded:', questionData);

        for (const pageKey in questionData) {
            console.log(`Processing page: ${pageKey}`);
            const questions = questionData[pageKey];
            questions.forEach(question => {
                console.log(`Processing question:`, question);

                const questionId = `q${question.qno}`;
                const storedSelection = localStorage.getItem(questionId);
                console.log(`Stored selection for ${questionId}: ${storedSelection}`);

                if (!storedSelection) {
                    console.warn(`No selection found in localStorage for ${questionId}`);
                    return;
                }

                const questionElement = document.getElementById(questionId);
                if (!questionElement) {
                    console.warn(`Question element not found on page for ID: ${questionId}`);
                    return;
                }

                console.log(`Found question element for ID: ${questionId}`);

                // Locate all `ul` elements related to this question
                const optionLists = questionElement.parentElement.querySelectorAll('ul');
                optionLists.forEach(optionsList => {
                    optionsList.querySelectorAll('label').forEach((label, index) => {
                        const input = optionsList.querySelector(`input[name="${questionId}"][value="${String.fromCharCode(97 + index)}"]`);
                        if (input) {
                            console.log(`Processing option: ${input.value} for question ${questionId}`);
                            if (answersRevealed) {
                                // Reset label colors to white
                                label.style.color = '#ffffff';
                                console.log(`Resetting color for option: ${input.value}`);
                            } else {
                                // Only process if the input is checked
                                if (input.checked) {
                                    console.log(`Option ${input.value} is checked`);
                                    if (input.value === question.ans) {
                                        console.log(`Correct answer for ${questionId}: ${input.value}`);
                                        label.style.color = '#49CDC8'; // Correct answer
                                    } else {
                                        console.log(`Incorrect answer for ${questionId}: ${input.value}`);
                                        label.style.color = '#AB6565'; // Incorrect answer
                                    }
                                } else {
                                    console.log(`Option ${input.value} is not checked`);
                                }
                            }
                        } else {
                            console.warn(`Input not found for option index ${index} in question ID: ${questionId}`);
                        }
                    });
                });
            });
        }

        // Toggle state after processing
        answersRevealed = !answersRevealed;
        console.log(`Answers revealed state toggled to: ${answersRevealed}`);
    };

    revealAnsButton.addEventListener('click', () => {
        console.log('Reveal Ans button clicked');
        revealAnswers();
    });
});


</script>


</body>
</html>