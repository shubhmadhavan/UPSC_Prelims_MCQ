<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Question Creator</title>
  <link href="data:image/x-icon;base64,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" rel="icon" type="image/x-icon" />
  <link rel="stylesheet" href="pre_Qcreator.css">
</head>
<body>

  <!-- <h1>Create Questions</h1>  -->
  <div id="form">
    <div class="form-group">
      <label for="file-name">File Name</label>
      <input type="text" id="file-name" placeholder="" value="" required>
    </div>
    <div class="form-group">
      <label for="qno">Question Number</label>
      <input type="number" id="qno" required>
    </div>
    <div class="form-group">
      <label for="qtype">Question Type</label>
      <select id="qtype">
        <option value="single">Single</option>
        <option value="stat">Statement</option>
        <option value="both">Both</option>
        <option value="assertion">Assertion</option>
      </select>
    </div>
    <div class="form-group">
      <label for="qtext">Question Text</label>
      <textarea id="qtext" required></textarea>
    </div>
    <div class="qhtml">
      <label for="qhtml">HTML</label>
      <textarea id="qhtml" style="height:40px;" required></textarea>
    </div>
    <div class="form-group">
      <label for="statements">Statements (newline-separated)</label>
      <textarea id="statements" style="height:60px;" required></textarea>
    </div>
    <div class="form-group">
      <label for="options">Options (newline-separated)</label>
      <textarea id="options" style="height:60px;" required></textarea>
    </div>
    <div class="form-group">
      <label for="ans">Answer</label>
      <input type="text" id="ans" required>
    </div>
    <button id="add-question" style="width:250px;">Add Question to Current Page</button>
    <button id="add-new-page" style="width:250px;">Add New Page and Question</button>
    <button id="save-json" style="width:250px;">Save JSON</button>
    <button id="undo" style="width: 150px;">Undo</button>
    <button id="redo" style="width: 150px;">Redo</button>
  </div>

  <div style="margin-top:20px;" id="json_preview">JSON Preview</div>
  <pre id="json-output">{}</pre>
  

  
<script>

  let jsonData = { page1: [] };
  let currentPage = "page1";
  let historyStack = [];
  let redoStack = []; // Stack for redo functionality
  
  document.getElementById("add-question").addEventListener("click", () => {
    saveHistory();
    addQuestion();
  });
  
  document.getElementById("add-new-page").addEventListener("click", () => {
    saveHistory();
    addNewPage();
  });
  
  document.getElementById("save-json").addEventListener("click", () => {
    saveJSON();
  });
  
  document.getElementById("undo").addEventListener("click", () => {
    undoLastChange();
  });
  
  document.getElementById("redo").addEventListener("click", () => {
    redoLastChange();
  });
  
  function saveHistory() {
    // Save a deep copy of the current jsonData
    historyStack.push(JSON.parse(JSON.stringify(jsonData)));
    // Clear redo stack when a new change is made
    redoStack = [];
  }
  
  function addQuestion() {
    const qno = document.getElementById("qno").value;
    const qtype = document.getElementById("qtype").value;
    const qtext = document.getElementById("qtext").value;
    const statements = document.getElementById("statements").value.split("\n").filter(Boolean);
    const options = document.getElementById("options").value.split("\n").filter(Boolean);
    const ans = document.getElementById("ans").value;
  
    const question = {
      qno: parseInt(qno),
      qtype,
      qtext,
      Statements: statements,
      qhtml: "<div></div>",
      options,
      ans,
    };
  
    jsonData[currentPage].push(question);
    updatePreview();
  }
  
  function addNewPage() {
    const newPage = `page${Object.keys(jsonData).length + 1}`;
    currentPage = newPage;
    jsonData[newPage] = [];
    addQuestion();
  }
  
  function updatePreview() {
    document.getElementById("json-output").textContent = JSON.stringify(jsonData, null, 2);
  }
  
  function saveJSON() {
    const fileName = document.getElementById("file-name").value || "questions.json";
    const blob = new Blob([JSON.stringify(jsonData, null, 2)], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = fileName;
    a.click();
  }
  
  function undoLastChange() {
  if (historyStack.length > 0) {
  redoStack.push(JSON.parse(JSON.stringify(jsonData))); // Save the current state to redo stack
  jsonData = historyStack.pop(); // Get the previous state from history stack
  updatePreview();
  showActionMessage("Undo");
  } else {
  console.log('No changes to undo');
  }
  }
  
  function redoLastChange() {
  if (redoStack.length > 0) {
  historyStack.push(JSON.parse(JSON.stringify(jsonData))); // Save current state to history stack
  jsonData = redoStack.pop(); // Get the most recent redo state
  updatePreview();
  showActionMessage("Redo");
  } else {
  console.log('No changes to redo');
  }
  }
  
  
  
  document.addEventListener("keydown", (event) => {
    if (event.ctrlKey && event.key === "Enter" && !event.shiftKey) {
      // Ctrl + Enter: Add Question to Current Page
      event.preventDefault();
      document.getElementById("add-question").click();
    } else if (event.ctrlKey && event.shiftKey && event.key === "Enter") {
      // Ctrl + Shift + Enter: Add New Page and Question
      event.preventDefault();
      document.getElementById("add-new-page").click();
    } else if (event.ctrlKey && event.shiftKey && event.key.toLowerCase() === "s") {
      // Ctrl + Shift + S: Save JSON
      event.preventDefault();
      document.getElementById("save-json").click();
    } else if (event.altKey && event.key.toLowerCase() === "z") {
      // Alt + Shift + Z: Undo
      event.preventDefault();
      document.getElementById("undo").click();
    } else if (event.altKey && event.key.toLowerCase() === "r") {
      // Alt + Shift + Z: Redo
      event.preventDefault();
      document.getElementById("redo").click();
    }
  });
  
  </script>
  
    <script> 
       // Function to show the hover box with the action message
   function showActionMessage(message) {
      const hoverBox = document.createElement("div");
      hoverBox.textContent = message;
      hoverBox.style.position = "fixed";
      hoverBox.style.bottom = "20px";
      hoverBox.style.right = "20px";
      hoverBox.style.backgroundColor = "#333";
      hoverBox.style.color = "#fff";
      hoverBox.style.padding = "10px";
    hoverBox.style.zIndex = "999";
      hoverBox.style.borderRadius = "5px";
      hoverBox.style.fontSize = "20px";
      hoverBox.style.opacity = "1";
      hoverBox.style.transition = "opacity 1s ease-in-out";
  
      document.body.appendChild(hoverBox);
  
      setTimeout(() => {
        hoverBox.style.opacity = "0";
        setTimeout(() => {
          hoverBox.remove();
        }, 500); // Wait for the fade-out effect before removing the box
      }, 500);
    }
  
    // Updated functions to show specific messages
    function undoLastChange() {
      if (historyStack.length > 0) {
        redoStack.push(JSON.parse(JSON.stringify(jsonData))); // Save current state to redo stack
        jsonData = historyStack.pop();
        updatePreview();
        showActionMessage("Undo");
      } else {
        console.log('No changes to undo');
      }
    }
  
    function redoLastChange() {
      if (redoStack.length > 0) {
        jsonData = redoStack.pop();
        updatePreview();
        showActionMessage("Redo");
      } else {
        console.log('No changes to redo');
      }
    }
  
    function saveJSON() {
      const fileName = document.getElementById("file-name").value || "questions.json";
      const blob = new Blob([JSON.stringify(jsonData, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = fileName;
      a.click();
      showActionMessage("JSON saved successfully");
    }
  
    function addQuestion() {
      const qno = document.getElementById("qno").value;
      const qtype = document.getElementById("qtype").value;
      const qtext = document.getElementById("qtext").value;
      const statements = document.getElementById("statements").value.split("\n").filter(Boolean);
      const options = document.getElementById("options").value.split("\n").filter(Boolean);
      const ans = document.getElementById("ans").value;
  
      // Safety checks
      if (!qno || !qtext) {
        alert("Empty qno or qtext field");
        document.getElementById("qno").focus(); // Focus back to the qno input
        return;
      }
      if (options.length < 4) {
        alert("Fill options");
        document.getElementById("options").focus(); // Focus back to the qno input
        return;
      }
      if (!ans) {
        alert("Ans field empty");
        document.getElementById("ans").focus(); // Focus back to the qno input
        return;
      }
  
      // Check if the qno already exists in the current page
      const questionExists = jsonData[currentPage].some(question => question.qno == qno);
      if (questionExists) {
        alert("qno already exists");
        document.getElementById("qno").focus(); // Focus back to the qno input
        return;
      }
  
      const question = {
        qno: parseInt(qno),
        qtype,
        qtext,
        Statements: statements,
        qhtml: "<div></div>",
        options,
        ans,
      };
  
      jsonData[currentPage].push(question);
      updatePreview();
      showActionMessage("Q added");
      document.getElementById("qno").focus(); // Focus back to the qno input
    }
  
    function addNewPage() {
      const qno = document.getElementById("qno").value;
      const qtext = document.getElementById("qtext").value;
      const options = document.getElementById("options").value.split("\n").filter(Boolean);
      const ans = document.getElementById("ans").value;
  
      // Safety checks
      if (!qno || !qtext) {
        alert("Empty qno or qtext field");
        document.getElementById("qno").focus(); // Focus back to the qno input
        return;
      }
      if (options.length < 4) {
        alert("Fill options");
        document.getElementById("options").focus(); // Focus back to the qno input
        return;
      }
      if (!ans) {
        alert("Ans field empty");
        document.getElementById("ans").focus(); // Focus back to the qno input
        return;
      }
  
      // Check if the qno already exists in the current page
      const questionExists = jsonData[currentPage].some(question => question.qno == qno);
      if (questionExists) {
        alert("qno already exists");
        document.getElementById("qno").focus(); // Focus back to the qno input
        return;
      }
  
      const newPage = `page${Object.keys(jsonData).length + 1}`;
      currentPage = newPage;
      jsonData[newPage] = [];
      addQuestion();
      showActionMessage("Q added to New Page");
      document.getElementById("qno").focus(); // Focus back to the qno input
    }
  
    </script>
  


</body>
</html>
